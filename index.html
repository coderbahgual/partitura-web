<!DOCTYPE html>
<html lang="en">
<head>
  <title>Mips Monociclo - Hierarquia de Memória</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="_plugins/bootstrap/css/bootstrap.min.css">
  <!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous"></head> -->
  <script src="_plugins/js/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="_plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
  <link rel="icon" href="_plugins/imgs/cpu.png" type="image/png" sizes="32x32">

  <style>
    .fakeimg {
        height: 200px;
        background: #aaa;
    }
    .table-font {
        font-size: 10pt;
        text-align: center;
    }
    .space-between {
        justify-content: space-between;
    }
    #table-reg td {
        padding: 1px;
    }
    #table-mem td {
        padding: 1px;
    }
    #table-cache td {
        padding: 1px;
    }
    .th-padding {
        padding: 4px 2px !important;
    }
    .card-inst {
        max-height: 330px;
        overflow: auto
    }
    .table-mem {
        max-height: 330px;
        overflow: auto
    }
    .fbold {
        font-weight: bold !important;
    }
    .bg-cell {
        background: #5bd778 !important;
    }
    .btn-badge{    
        padding: 2px 8px;
        margin: 0px 4px;
    }
    .font-badge-hm{
        font-size: 10pt;
    }
  
  </style>
</head>
<body>

<div class="text-center" style="margin-bottom:0">
  <h2>Mips Monociclo - Hierarquia de Memória</h2>
</div>

<nav class="navbar navbar-expand-sm bg-light navbar-dark justify-content-center">
    <div class="btn-group">
        <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-target="#myModal">
            Configurações do Simulador
        </button>
        <a href="?base=hex" role="button" class="btn btn-outline-primary ">Hex</a>
        <a href="?base=dec" role="button" class="btn btn-outline-primary ">Dec</a>
        <a href="?base=bin" role="button" class="btn btn-outline-primary ">Bin</a>
        <button type="button" class="btn btn-outline-success" id="btn-exe" >Executar</button>
        <!-- &nbsp;&nbsp;&nbsp;&nbsp;<div class="spinner-border text-success" id="spinnerB"></div> -->
        &nbsp;&nbsp;&nbsp;&nbsp;<div class="spinner-grow text-success" id="spinner"></div>
    </div>
</nav>

<div class="container" style="margin-top:20px;">
    <!-- Alertas -->
    <!-- <div class="alert alert-warning table-font">
        <strong>Atenção!</strong> Até o momento este simulador tem suporte para a execução 
        do seguinte subconjunto de instruções do MIPS: load word (lw), store word (sw), 
        branch equal (beq), add, sub, and, or, nor, set on less than (slt), jump (j), 
        jump register (jr), shif left (sll), shift right (srl).
    </div> -->
    
    <div class="alert alert-secondary d-none">
        <strong>Success!</strong> Indicates a successful or positive action.
    </div>
    <!-- ./Alertas -->

    <div class="row">
        <div class="col-md-3 col-sm-12">
            <div class="">
                <h3>Registradores</h3>
                <table class="table table-bordered table-font table-striped">
                    <!-- <thead class="thead-dark"> -->
                    <thead class="">
                        <tr>
                            <th>ID</th>
                            <th>Reg</th>
                            <th>Conteúdo</th>
                            <!-- <th>ID</th>
                            <th>Reg</th>
                            <th>Conteúdo</th> -->
                        </tr>
                    </thead>
                    <tbody id="table-reg">
                        <tr>
                            <td></td>
                            <td>PC</td>
                            <td><=$PC></td>
                        </tr>
                        <!-- <tr>
                            <td>x</td>
                            <td>IR</td>
                            <td><=$IR></td>
                        </tr> -->
                    
                    </tbody>
                </table>
                <hr class="d-sm-none">
            </div>
            <!-- <div class="">
                <h3>Desempenho</h3>
                <table class="table table-bordered table-font">
                    <thead>
                        <tr>
                            <th>Firstname</th>
                            <th>Lastname</th>
                            <th>Email</th>
                            <th>Email</th>
                        </tr>
                    </thead>
                    <tbody id="table-cache">
                    <php for ($i = 0; $i < 10; $i++): >
                        <tr>
                            <td>John</td>
                            <td>Doe</td>
                            <td>john@example.com</td>
                            <td>john@example.com</td>
                        </tr>
                    <php endfor; >
                    </tbody>
                </table>
                <hr class="d-sm-none">
            </div> -->
        </div>
        <div class="col-md-9 col-sm-12">
            <div class="row">
                <div class="col-md-6 col-sm-12">
                    <h3>Instruções</h3>
                    <div class="table-responsive table-mem">
                        <table class="table table-bordered table-font">
                            <thead>
                                <tr>
                                    <th>Execução</th>
                                    <th>Instrução</th>
                                </tr>
                            </thead>
                            <tbody id="table-mem">
                                <tr class="<='bg-cell';>">
                                    <td>
                                        <img src="_plugins/imgs/next.png" class="" alt="next" width="18px">
                                    </td>
                                    <td><=$INSTRUCOES[$i-1]['mne']></td>
                                </tr>
                                <tr class="">
                                    <td></td>
                                    <td><=$INSTRUCOES[$i-1]['mne']></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <hr class="d-sm-none">
                </div>
                <div class="col-md-6 col-sm-12">
                    <h3>Memória Principal</h3>
                    <div class="table-responsive table-mem">
                        <table class="table table-bordered table-font table-striped">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Instruções/Dados</th>
                                    <!-- <th>Bloco</th> -->
                                </tr>
                            </thead>
                            <tbody id="table-mem">
                                <tr>
                                    <td><=$PALAVRA['idx'];></td>
                                    <td><=$PALAVRA['ins'][$base];></td>
                                    <!-- <td><=$PALAVRA['bloco']></td> -->
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <hr class="d-sm-none">
                </div>
            </div>
            <div class="row">
                <div class="col-md-6 col-sm-12">
                    <h3>Cache de Instruções <span class="badge badge-success font-badge-hm">hit: <=$CACHEI_HIT></span> <span class="badge badge-danger font-badge-hm">miss: <=$CACHEI_MIS></span></h3>
                    <table class="table table-bordered table-font table-striped">
                        <thead>
                                <tr>
                                <th class="th-padding">ID</th>
                                <th class="th-padding">V</th>
                                <th class="th-padding">Tag</th>
                                <th class="th-padding">Instruções</th>
                            </tr>
                            <tr>
                                <th class="th-padding">ID</th>
                                <th class="th-padding">V</th>
                                <th class="th-padding">Tag</th>
                                <th class="th-padding">Instruções</th>
                                <th class="th-padding">V</th>
                                <th class="th-padding">Tag</th>
                                <th class="th-padding">Instruções</th>
                            </tr>
                        </thead>
                        <tbody id="table-cache">
                            <tr>
                                <td><=$INST['i']></td>
                                <td><=$INST['v']></td>
                                <td><=$INST['t']></td>
                                <td>
                                    <=$palavra>&nbsp;
                                </td>
                            </tr>
                            <tr>
                                <td><=$i></td>
                                <td>0</td>
                                <td>0x0</td>
                                <td>0x12345678</td>

                                <td>0</td>
                                <td>0x0</td>
                                <td>0x12345678</td>
                            </tr>
                        </tbody>
                    </table>
                    <hr class="d-sm-none">
                </div>
                <div class="col-md-6 col-sm-12">
                    <h3>Cache de Dados <span class="badge badge-success font-badge-hm">hit: <=$CACHED_HIT></span> <span class="badge badge-danger font-badge-hm">miss: <=$CACHED_MIS></span></h3>
                    <table class="table table-bordered table-font table-striped">
                        <thead>
                                <tr>
                                <th class="th-padding">ID</th>
                                <th class="th-padding">V</th>
                                <th class="th-padding">Tag</th>
                                <th class="th-padding">Dados</th>
                            </tr>
                            <tr>
                                <th class="th-padding">ID</th>
                                <th class="th-padding">V</th>
                                <th class="th-padding">Tag</th>
                                <th class="th-padding">Dados</th>
                                <th class="th-padding">V</th>
                                <th class="th-padding">Tag</th>
                                <th class="th-padding">Dados</th>
                            </tr>
                        </thead>
                        <tbody id="table-cache">
                            <tr>
                                <td><=$DADO['i']></td>
                                <td><=$DADO['v']></td>
                                <td><=$DADO['t']></td>
                                <td>
                                    <=$palavra>&nbsp;
                                </td>
                            </tr>
                            <tr>
                                <td><=$i></td>
                                <td>0</td>
                                <td>0x0</td>
                                <td>0x12345678</td>

                                <td>0</td>
                                <td>0x0</td>
                                <td>0x12345678</td>
                            </tr>
                        </tbody>
                    </table>
                    <hr class="d-sm-none">
                </div>
            </div>
        </div>
    </div>
</div>

<!-- The Modal -->
<div class="modal fade" id="myModal">
    <div class="modal-dialog modal-md">
      <div class="modal-content">
      
        <!-- Modal Header -->
        <div class="modal-header">
          <h4 class="modal-title">Configurações do Simulador</h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>

        <form method="POST" action="controller.php" enctype="multipart/form-data">
            <!-- Modal body -->
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="selectCacheInst" class="fbold">Cache de Instruções:</label>
                            <select class="form-control" id="selectCacheInst" name="selectCacheInst">
                                <option value="1">Diretamente Mapeada</option>
                                <option value="2">Associativa Duas Vias</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control numero" placeholder="Conjuntos" id="txtCacheInstConj" name="txtCacheInstConj" maxlength="4" required>
                            <div class="invalid-feedback" id="if-txtCacheInstConj">Conjuntos inválidos! Por favor informe um valor multiplo de 2.</div>
                            <div class="valid-feedback" id="vf-txtCacheInstConj">Conjuntos ok!</div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="selectCacheDado" class="fbold">Cache Dados:</label>
                            <select class="form-control" id="selectCacheDado" name="selectCacheDado">
                                <option value="1">Diretamente Mapeada</option>
                                <option value="2">Associativa Duas Vias</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control numero" placeholder="Conjuntos" id="txtCacheDadoConj" name="txtCacheDadoConj" maxlength="4" required>
                            <div class="invalid-feedback" id="if-txtCacheDadoConj">Conjuntos inválidos! Por favor informe um valor multiplo de 2.</div>
                            <div class="valid-feedback" id="vf-txtCacheDadoConj">Conjuntos ok!</div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-12"> 
                        <div class="form-group">
                            <label for="txtTamMem" class="fbold">Palavras Memória:</label>
                            <input type="text" class="form-control numero" placeholder="Palavras" id="txtTamMem" name="txtTamMem" maxlength="5" required>
                            <div class="invalid-feedback" id="if-txtTamMem">Palavras inválidas! Por favor informe um valor multiplo de 2.</div>
                            <div class="invalid-feedback" id="if-txtTamMemC">Palavras inválidas! Por favor informe um valor maior do que os conjuntos.</div>
                            <div class="valid-feedback" id="vf-txtTamMem">Palavras ok!</div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-12"> 
                        <div class="form-group"> 
                            <p class="alert alert-warning small">
                                Caso precisa de ajuda para gerar instruções no formato MIPS,
                                utilize a plataforma <a href="https://godbolt.org/" target="_blank">godbolt</a>.
                                <b>Obs. é aceito somente arquivos com extensão *.txt.<!-- e .asm.--></b>
                            </p>
                        </div>
                        <div class="form-group" id="inputArquivo">
                            <label for="arquivo" class="fbold">Carregar instruções:</label>
                            <input type="file" class="form-control-file border" name="arquivo" id="arquivo" required>
                            <div class="invalid-feedback" id="if-arquivo">Arquivo inválido!</div>
                            <div class="valid-feedback" id="vf-arquivo">Arquivo ok!</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Modal footer -->
            <div class="modal-footer space-between">
                <button type="button" class="btn btn-danger" data-dismiss="modal">Fechar</button>
                <button type="submit" class="btn btn-success" id="btn-iniciar" disabled>Iniciar</button>
            </div>
        </form>
        
      </div>
    </div>
  </div>

<div class="jumbotron text-center" style="margin-bottom:0">
  <p>&copy; 2022 <a href="https://coderbahgual.github.io/" target="_blank">coderbahgual</a></p>
</div>

<script src="_plugins/js/masks.js"></script>
<script type="text/javascript" src="_plugins/js/index.js"></script>
<script type="text/javascript"></script>

</body>
</html>